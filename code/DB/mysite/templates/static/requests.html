{% extends "static\general_extend.html" %}{% load static %}

{% block title %} Заявки {% endblock %}

{% block head_temp %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static '\css\style_show.css' %}"/>
    <link rel="icon" type="image/png" href="{% static '\css\img\favicon.ico' %}"/>
{% endblock %}

{% block name_info %}
    {{ block.super }}
{% endblock %}

{% block content %}
<div class="show-voucher">
    <form class="show-form p-l-25 p-r-25 p-t-30" method="POST" action="{% url 'hunters:buy' %}">
        {% csrf_token %}

        {% if info_message %}
            <div class="alert-info">
                <strong>{{ info_message }}</strong>
            </div>
        {% endif %}

        {% if error_message %}
            <div class="alert-danger">
                <strong>{{ error_message }}</strong>
            </div>
        {% endif %}
        
        <div class="voucher-table">
            {% if requests %}
            <input 
                type="text" 
                id="find-voucher-ground" 
                class="find-voucher-ground" 
                onkeyup="FindNeed()" 
                pattern="[А-Яа-яЁё\-]*"
                placeholder="Поиск ФИО ...">

            <table class="list-table fix-col fix-col-3" id="list-table">
                <tr>
                    <th><b>ФИО</b></th>
                    <th><b>Телефон</b></th>
                    <th><b>Электронная почта</b></th>
                    <th><b>Номер заявки</b></th>
                    <th><b>Животное</b></th>
                    <th><b>Количество</b></th>
                    {% if request.session.user.role_eng == 'admin' %}
                    <th><b>Субъект</b></th>
                    <th><b>Сектор</b></th>
                    {% endif %}
                    <th><b>Решение</b></th>
                </tr>

                {% for elem in requests %}
                <tr class="items">
                    <td>{{elem.full_name}}</td>
                    <td>{{elem.mobile_phone}}</td>
                    <td>{{elem.email}}</td>
                    <td>{{elem.id_voucher}}</td>
                    <td>{{elem.animal}}</td> 
                    <td>{{elem.amount_animals}}</td>
                    {% if request.session.user.role_eng == 'admin' %}
                    <td>{{elem.ground_name}}</td>
                    <td>{{elem.id_sector}}</td>
                    {% endif %}
                    <td>
                        <div style="display: flex; justify-content: center;">
                            <a href="{% url 'vouchers:accept' elem.id_voucher %}" class="btn-del"> ✔ </a>
                            <a href="{% url 'vouchers:reject' elem.id_voucher %}" class="btn-del"> ✖ </a>
                        </div>
                    </td>

                </tr>
                {% endfor %}
            </table>
            {% else %}
            <div class="alert alert-exist">
                <strong>Нет заявок</strong>
            </div>
            {% endif %}

        </div>  
    </form>
</div>


{% endblock %}